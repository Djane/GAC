<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>
		<style type="text/css"/>
		<script language="javascript">
			function imprimirNoFramePadrao() {
				dlgRelatorio.show();
				$("#formRel").prop("target", "relatorioIframe");			        
			} 
		
			function printIframe() { 
				window.frames['relatorioIframe'].focus();
		        window.frames['relatorioIframe'].print(); 				
			}
		
			function closeIframe() { 
				$('#relatorioIframe').attr('src', "http://www.andyjacobson.com/wp-content/uploads/2011/06/processing.gif")				
			}
		</script>
	</h:head>

	<h:body>
		<h:form id="formRel">
			<p:growl id="messagesHistoricoDispositivo" showDetail="false" sticky="false" />
			<ui:include src="inc/cabecalho.xhtml" />
			<h:panelGrid id="separador1" border="0"></h:panelGrid>

			<div align="center" style="width: '100%;'">

				<!-- Parametros -->			
				<h:panelGrid columns="1" border="0" columnClasses="alignLeftTop" style="width:450px;">						
					<p:panelGrid columns="1" id="idPanelCamposHistoricoDispositivo" style="width:450px;">						
						<h:panelGrid columnClasses="noBorder">
							<h:panelGrid id="idPgdAgrupamentoCamposHistoricoDispositivo" style="width:400px;" columns="2" columnClasses="noBorder, noBorder">					
								<h:outputLabel for="idDispositivo" value="#{messageBundle['label.relhistdispositivo.field.iddispositivo']}" styleClass="text-bold"/>
								<h:outputLabel for="idLoginCliente" value="#{messageBundle['label.relhistdispositivo.field.login']}" styleClass="text-bold"/>
								<p:inputText id="idDispositivo" value="#{relatorioHistoricoDispositivoBean.relatorio.idDispositivo}" 
									maxlength="13"/> 								
								<p:inputText id="idLoginCliente" value="#{relatorioHistoricoDispositivoBean.relatorio.login}"/>

								<h:outputLabel for="idCmbEstado" value="#{messageBundle['label.relhistdispositivo.field.estado']}" styleClass="text-bold"/>
								<h:outputText styleClass="text-bold" value="#{messageBundle['label.relhistdispositivo.field.dataMovimentacao']}" />		
								<p:selectOneMenu id="idCmbEstado"
									value="#{relatorioHistoricoDispositivoBean.relatorio.estadoAtualParam}" 
									style="width:145px;"
									validatorMessage="#{messageBundle['message.cadastrodispositivo.field.estado.required']}">
									<f:selectItem itemValue="0" itemLabel="Selecione..." />
									<f:selectItems value="#{relatorioHistoricoDispositivoBean.listaEstadoDispositivo}"/>										
								</p:selectOneMenu>
								<p:calendar value="#{relatorioHistoricoDispositivoBean.relatorio.dataMovimentacao}"
											mode="popup" id="idDataMovimentacao" pattern="dd/MM/yyyy"/>	
							</h:panelGrid>
						</h:panelGrid>
					</p:panelGrid>		
					
					<!-- Barra de botões -->
					<p:panelGrid id="idPgdBotoesHistoricoDispositivo" columns="1" border="0" style="width:450px;" columnClasses="alignRightTop">							
						<h:panelGroup id="idPgpBotoesHistoricoDispositivo">															
							<p:commandButton id="idCmdRelatorioHistoricoDispositivo"
								icon="ui-icon-print" style="margin:0"
								value="#{messageBundle['label.generic.button.execute']}"
								ajax="false"
								process="@this"
								actionListener="#{relatorioHistoricoDispositivoBean.imprimirHistoricoDispositivos}"
								tabindex="0" />																						
							<h:outputLabel value="" />
							
							<p:commandButton value="#{messageBundle['label.generic.button.close']}" 
								icon="ui-icon-circle-close" style="margin:0" immediate="true" 
								ajax="false" action="#{relatorioHistoricoDispositivoBean.retornarMenuPrincipal}"/>
							</h:panelGroup>
					</p:panelGrid>							
				</h:panelGrid>
				<h:panelGrid id="panelRodapeRelatorioHistoricoDispositivo">
					<h:outputLabel value="" />
				</h:panelGrid>

			</div>
		</h:form>
		
		<p:dialog id="relatorioDialog" header="Relatório" widgetVar="dlgRelatorio" modal="true" 
			maximizable="true" width="800" height="500" draggable="false"  onHide="closeIframe();" >			
			<p:panelGrid id="idPgdBotoesIframeRelatorio" columns="1" columnClasses="alignRight" style="width:100%;"> 
				<p:commandButton type="button" onclick="printIframe();" value="Imprimir"/>
			</p:panelGrid>
			<h:panelGrid></h:panelGrid>
			<iframe id="relatorioIframe" src="http://www.andyjacobson.com/wp-content/uploads/2011/06/processing.gif"  name="relatorioIframe" class="noBorder" style="width:100%;height:100%" scrolling="no" />						
		</p:dialog>
	</h:body>
</f:view>
</html>