<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	
<f:view>
<h:head>
		<style type="text/css">
		
			.xpto2 {
				width:1024px;
				
			}
		
			.grupoDadosDireitaCliente {
				border: none !important;
				border-style : none !important;				
				border-width: 0 !important;			
				vertical-align: top;			
			}
		
			.grupoBotoesEsquedaCliente {
				border: none !important;
				border-style : none !important;				
				border-width: 0 !important;			
				vertical-align: top;			
			}
		
			.grupoBotoesDireita {
				border: none !important;
				border-style : none !important;				
				border-width: 0 !important;			
				text-align:right !important;			
			}
			
			.areaVerde{
				background-color:#00FF00;
				text-align:center ;
				color :#000000;
			}
			
			.areaAmarela{
				background-color:#FAD42E;
				text-align:center ;
				color :#000000;
			}
			
			.areaVermelha{
				background-color:#FF0000;
				text-align:center ;
				color :#FFFFFF;
			}

			.areaBranca{
				background-color:##FFFFFF;
				text-align:center ;
				color :#000000;
			}
			
			.ui-panelgrid .radioButton td {
			    border-color: inherit;
			    border-style: none;
			    border-width: 0px;
			    font-weight : bold;	
			    padding: 4px 4px;
			}
			
			.ui-picklist-list {
				width: 470px !important;
				height: 300px !important;
			}			
		</style>
		<script language="javascript">	
			function modalExcluirPessoaContato(parametro) {
				$("#frmAtendimento\\:txtIdContato").val(parametro);
				excluirPessoaDeContatoDoCliente.show();
			}		


			function updateFormPessoaContatoCliente() {
				displayTelefoneEmailPessoaContatoCliente($(
						"#frmAtendimento\\:idCmbTipoFormaContatoPessoaContatoCliente :selected").val());
			}
			
			function updateFormContatoCliente() {				     
				displayTelefoneEmailCliente($(
						"#frmAtendimento\\:idCmbTipoFormaContatoCliente :selected").val());
			}
			
			function displayTelefoneEmailPessoaContatoCliente(tipoContato) {
				if (tipoContato == 4) {
					$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteEmail").css("display",
							"block");
					$("#frmAtendimento\\:idLblFormaContatoPessoaContatoClienteEmail").css("display",
							"block");
					$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").css("display",
							"none");
					$("#frmAtendimento\\:idLblFormaContatoPessoaContatoClienteTelefone").css("display",
							"none");
				} else {
					$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteEmail")
							.css("display", "none");
					$("#frmAtendimento\\:idLblFormaContatoPessoaContatoClienteEmail")
							.css("display", "none");

					if (tipoContato == 1) {
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").removeClass(
								"telefoneFixoMask");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").addClass(
								"telefoneCelularMask");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").mask(
								"(99)99999-9999");
						$("#frmAtendimento\\:idLblFormaContatoPessoaContatoClienteTelefone").css("display",
								"block");
					} else {
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idLblFormaContatoPessoaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").addClass(
								"telefoneFixoMask");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").removeClass(
								"telefoneCelularMask");
						$("#frmAtendimento\\:idTxtFormaContatoPessoaContatoClienteTelefone").mask(
								"(99)9999-9999");
					}
					fixarMascara();

				}
			}		
			
			function modalExcluirFormaContatoPessoaContatoCliente(parametro) {
				$("#frmAtendimento\\:txtIdFormaContatoPessoaContatoCliente").val(parametro);
				excluirFormaContatoPessoaDeContatoDoCliente.show();
			}
			
			
			function displayTelefoneEmailCliente(tipoContato) {
				if (tipoContato == 4) {
					$("#frmAtendimento\\:idTxtFormaContatoClienteEmail").css("display",
							"block");
					$("#frmAtendimento\\:idLblFormaContatoClienteEmail").css("display",
							"block");
					$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").css("display",
							"none");
					$("#frmAtendimento\\:idLblFormaContatoClienteTelefone").css("display",
							"none");
				} else {
					$("#frmAtendimento\\:idTxtFormaContatoClienteEmail")
							.css("display", "none");
					$("#frmAtendimento\\:idLblFormaContatoClienteEmail")
							.css("display", "none");

					if (tipoContato == 1) {
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").removeClass(
								"telefoneFixoMask");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").addClass(
								"telefoneCelularMask");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").mask(
								"(99)99999-9999");
						$("#frmAtendimento\\:idLblFormaContatoClienteTelefone").css("display",
								"block");
					} else {
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idLblFormaContatoClienteTelefone").css("display",
								"block");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").addClass(
								"telefoneFixoMask");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").removeClass(
								"telefoneCelularMask");
						$("#frmAtendimento\\:idTxtFormaContatoClienteTelefone").mask(
								"(99)9999-9999");
					}
					fixarMascara();

				}
			}		
			
			function modalExcluirFormaContatoCliente(parametro) {
				$("#frmAtendimento\\:txtIdFormaContatoCliente").val(parametro);
				excluirFormaContatoCliente.show();
			}
			
			function modalExcluirTratamento(parametro) {
				$("#frmAtendimento\\:txtIdTratamento").val(parametro);
				excluirTratamento.show();
			}
			
			function modalExcluirCentral(id) {
				$("#frmAtendimento\\:idTxtIdDispositivo").val(id);
				excluirCentralSelecionada.show();
			}

			function modalExcluirDispositivo(id) {
				$("#frmAtendimento\\:idTxtIdDispositivo").val(id);
				excluirDispositivoSelecionado.show();
			}

			function handleSelecionarCentralRequest(xhr, status, args) {
				if (!args.validationError) {
					modalSelecionarCentral.hide()
				}
			}		
			
			function handleLigacaoPessoaContatoCompletada(xhr, status, args) {
				dlgCalling.hide();
				if (args.callComplete) {
					$('#frmAtendimento\\:idPanelGridBarraBotoesGACPhonePessoaContato').css('display', 'block')
					$("#frmAtendimento\\:idTabAtendimento\\:cmdLigarPessoaContatoDoCliente").addClass("ui-state-disabled");
				} else {					
					 $('#messageGACPhone').text(args.GACPhoneMessage);
					dlgGacPhoneMessage.show();
					$('#frmAtendimento\\:idPanelGridBarraBotoesGACPhonePessoaContato').css('display', 'none')
					$("#frmAtendimento\\:idTabAtendimento\\:cmdLigarPessoaContatoDoCliente").removeClass("ui-state-disabled");
				}
			}
			
			function handleEncerrarLigacaoPessoaContatoCompletada(xhr, status, args) {			
				$('#frmAtendimento\\:idPanelGridBarraBotoesGACPhonePessoaContato').css('display', 'none')
				$("#frmAtendimento\\:idTabAtendimento\\:cmdLigarPessoaContatoDoCliente").removeClass("ui-state-disabled");

			}			
			
			function handleConcluirEnvioEmailContato(xhr, status, args) {
				if (args.sucess) {
					modalEmailPessoaContatoDoCliente.hide();
				}
				dlgWaiting.hide();
			}				
			
			displayTelefoneEmailPessoaContatoCliente(1);
			displayTelefoneEmailCliente(1)
			
		</script>
		
	</h:head>

	<h:body>
		<ui:include src="inc/modal_waiting.xhtml" />
		<ui:include src="inc/modal_calling.xhtml" />
		<ui:include src="inc/modal_gacphone_message.xhtml" />
		
		<h:form id="frmAtendimento">
		
			<h:inputHidden id="txtIdContato" value="#{atendimentoBean.pessoaParaContato.idContato}" />
			<h:inputHidden id="idTxtIdDispositivo" value="#{atendimentoBean.idDispositivo}" />
			<h:inputHidden id="txtIdHorario" value="#{atendimentoBean.horarioTratamento}" />
			<h:inputHidden id="txtIdTratamento"
					value="#{contratoBean.tratamento.idTratamento}" />
			<p:growl id="growMessage" showDetail="false" sticky="false" />
			<ui:include src="inc/cabecalho.xhtml" />
			<h:panelGrid id="separador1" border="0"></h:panelGrid>

			<div align="center" style="width: '100%;'">
	
				<h:panelGrid id="idPgdPrincipal" style="width:1024px;" cellspacing="0">
					
					<p:panelGrid id="idPgdBox" columns="1" style="width: 100%;">  
				
						<p:panelGrid id="idPngSemaforo" columns="3" styleClass="noBorder" 
							columnClasses="#{atendimentoBean.cssBoxMensagemPrioridade}, alignCenter,alignRight" style="width: 100%;">
							<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.tipoOcorrencia.descricaoTipoOcorrencia}" styleClass="text-bold"/>
							<h:panelGroup>
									<h:outputText value="Ocorrência nº " styleClass="text-bold"/>
									<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.idOcorrencia}" styleClass="text-bold"/>								
							</h:panelGroup>
							
							<h:panelGroup>								
								<h:commandButton image="#{atendimentoBean.ledSemaforoVerde}"								 
									 action="#{atendimentoBean.mudarPrioridade(1)}" >
									<f:ajax execute="frmAtendimento:idPngSemaforo" render="frmAtendimento:idPngSemaforo" />
								</h:commandButton>
								
								<h:commandButton image="#{atendimentoBean.ledSemaforoAmarelo}"
									action="#{atendimentoBean.mudarPrioridade(2)}" rendered="true" immediate="true">
									<f:ajax execute="frmAtendimento:idPngSemaforo" render="frmAtendimento:idPngSemaforo" />
								</h:commandButton>
									
								<h:commandButton  image="#{atendimentoBean.ledSemaforoVermelho}"
									action="#{atendimentoBean.mudarPrioridade(3)}">
									<f:ajax execute="frmAtendimento:idPngSemaforo" render="frmAtendimento:idPngSemaforo"></f:ajax>
								</h:commandButton>
							</h:panelGroup>
						</p:panelGrid>

						<h:panelGroup >
							<h:panelGrid columns="2" columnClasses="grupoBotoesEsquedaCliente, grupoDadosDireitaCliente" width="100%">
								<h:panelGroup>
									<h:panelGrid id="grupo1" columns="3" columnClasses="noBorder, noBorder, noBorder, noBorder">
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.nome}" styleClass="text-bold"/>
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.idade} anos" styleClass="text-bold"/>										
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.sexo}" styleClass="text-bold">
											<f:converter converterId="labelSexoConverter"/>
										</h:outputText>
									</h:panelGrid>
							
									<h:panelGrid id="grupo2" columns="1" columnClasses="noBorder">
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.endereco.endereco}, Bairro #{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.endereco.bairro}, #{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.endereco.cidade}, #{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.endereco.uf}, #{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.endereco.cep} " styleClass="text-bold"/>										
									</h:panelGrid>
		
			
									<h:panelGrid id="grupo3" columns="" styleClass="radioButton" border="0" >
									 	<p:selectOneRadio id="options" value="1" >  
            								<f:selectItems  value="#{atendimentoBean.telefonesContatoComCliente}" />
            								<f:converter converterId="telefoneConverter"/>
        								</p:selectOneRadio>  
									</h:panelGrid>									
								</h:panelGroup>	
								
								<h:panelGroup>																
									<h:panelGrid id="idPngGridDadosDireita" columns="4" columnClasses="noBorder, noBorder, noBorder, noBorder, noBorder">
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.planoSaude}" styleClass="text-bold"/>
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.cobertura}" styleClass="text-bold"/>
									</h:panelGrid>
									<h:panelGrid columnClasses="noBorder" columns="1"  style="width:500px;"  >
										<h:outputText value="#{atendimentoBean.ocorrenciaEmAndamento.contrato.cliente.necessidadeEspecial}" styleClass="text-bold"/>
									</h:panelGrid>									
								</h:panelGroup>		
							</h:panelGrid>
							
							<h:panelGrid id="grupoBotoes" columns="2" columnClasses="noBorder, grupoBotoesDireita" border="0" width="100%">						
								<h:panelGroup>
									<p:commandButton value="Ligar" />									
									<p:commandButton value="SMS" />
									<p:commandButton value="Mais Tarde" type="button" onclick="modalDadosMaisTarde.show();" />
									<p:commandButton value="Em Espera" />
									<p:commandButton value="Encerrar" />
									<p:commandButton value="Fechar" ajax="false" action="#{atendimentoBean.encerrarTelaRegistroOcorrencia}" immediate="true"/>
								</h:panelGroup>
									
								<h:panelGroup>
									<p:commandButton value="Contratos" style="width:100px;" type="button" onclick="modalContrato.show();"/>
									<p:commandButton value="Contatos" style="width:100px;" type="button" onclick="modalPessoaDeContatoDoCliente.show();" />
									<p:commandButton value="Dispositivo" style="width:100px;" type="button" onclick="modalDispositivosDoCliente.show();"/>
								</h:panelGroup>
							</h:panelGrid>
						</h:panelGroup>						
					</p:panelGrid>
					
					<!--TABVIEW _____#########################################-->
					
					<p:panelGrid columns="1" id="idPanelGridBarraBotoesGACPhonePessoaContato"
						style="width:1024px;text-align:right !important;padding-right:0px;display:none" border="2" columnClasses="xpto2">
						<h:panelGroup id="idGroupBarraBotoesGACPhonePessoaContato">
							<h:outputText value="Contato acionado: " styleClass="text-bold"/>							
							<h:outputText value="#{atendimentoBean.contatoSelecionado.nome} " styleClass="text-bold"/>							
							<h:outputText value="#{atendimentoBean.formaContatoAcionamentoTelefonico.telefone}" styleClass="text-bold">
								<f:converter converterId="telefoneConverter" />
							</h:outputText>
							<h:outputText value="  "/>
							<p:commandButton id="cmdColocaremEsperaPessoaDeContato"
								value="#{messageBundle['label.generic.button.call.pause']}"
								icon="ui-icon-check" style="margin:0"
								type="button" onclick="alert('Em desenv')" />
							<h:outputLabel />
							<p:commandButton id="cmdEncerrarLigacaoPessoaDeContato"
								value="#{messageBundle['label.generic.button.call.end']}"
								icon="ui-icon-circle-close" style="margin:0" ajax="true"										
								process="@this"
								actionListener="#{atendimentoBean.encerrarLigacaoParaPessoaDeContato}"
								oncomplete="handleEncerrarLigacaoPessoaContatoCompletada(xhr, status, args)"
								/>
						</h:panelGroup>
					</p:panelGrid>
					
					<p:tabView id="idTabAtendimento" style="width:100%;">
					    <p:tab id="acpTabContatos" title="Contatos">  
					        <h:panelGrid id="pgdTablesContato" columns="3" border="0" styleClass="noBorder" columnClasses="alignLeftTop, alignRightTop, alignRightTop"> 

									<p:dataTable id="idDtbContatos" var="item"										
										selection="#{atendimentoBean.contatoSelecionado}"
										selectionMode="single"														
										value="#{atendimentoBean.contatoDataModel}" rendered="true"
										emptyMessage="#{messageBundle['message.contrato.datatable.contato.empty']}" >

									<p:ajax event="rowSelect"
										listener="#{atendimentoBean.atualizarGradeFormaContato}"
										update=":frmAtendimento:idTabAtendimento:idDtbContatos, :frmAtendimento:idTabAtendimento:idDtbFormaContato, 
										:frmAtendimento:idTabAtendimento:idPngBotoesAcaoContato, :frmAtendimento:idModalSmsPessoaContatoDoCliente, :frmAtendimento:idModalEmailPessoaContatoDoCliente" />

									<p:column style="width:300px;" >
											<f:facet name="header">
												<h:outputText
													value="#{messageBundle['label.contrato.datatable.contato.column.1']}" />
											</f:facet>
											<h:outputText value="#{item.nome}" />
										</p:column>

										<p:column style="width:150px;">
											<f:facet name="header">
												<h:outputText
													value="#{messageBundle['label.contrato.datatable.contato.column.2']}" />
											</f:facet>
											<h:outputText value="#{item.grauParentesco}" >
												<f:converter converterId="grauParentescoConverter"> </f:converter>
											</h:outputText>
										</p:column>
										
										<p:column style="width:100px;">
											<f:facet name="header">
												<h:outputText
													value="#{messageBundle['label.contrato.datatable.contato.column.3']}" />
											</f:facet>
											<h:outputText value="#{item.sqaChamada}" />
										</p:column>			
										
										<p:column style="width:50px;">
											<f:facet name="header">
												<h:outputText
													value="Chamado ?" />
											</f:facet>
											<h:outputText value="N" />
										</p:column>		

									</p:dataTable>
															
									<p:dataTable id="idDtbFormaContato" var="item"
										selection="#{atendimentoBean.formaContatoAcionamentoTelefonico}"
										selectionMode="single"	 
										value="#{atendimentoBean.formaContatoDataModel}" rendered="true"										
										emptyMessage="#{messageBundle['message.contrato.datatable.formacontato.empty']}"  >
										
										<p:ajax event="rowSelect" listener="#{atendimentoBean.formaContatoPessoaClienteSelecioada}"
											update=":frmAtendimento:idTabAtendimento:idDtbFormaContato, :frmAtendimento:idTabAtendimento:idPngBotoesAcaoContato, :frmAtendimento:idModalSmsPessoaContatoDoCliente, :frmAtendimento:idModalEmailPessoaContatoDoCliente" /> 
										
										<p:column style="text-align:left;width:100px;">
											<f:facet name="header">
												<h:outputText
													value="#{messageBundle['label.contrato.datatable.formacontato.column.1']}" />
											</f:facet>
											<h:outputText value="#{item.tipoContato}" >
												<f:converter converterId="formaContatoConverter"/> 
											</h:outputText>
										</p:column>

										<p:column style="width:180px;">
											<f:facet name="header">
												<h:outputText
													value="#{messageBundle['label.contrato.datatable.formacontato.column.2']}/Email" />
											</f:facet>
											<h:outputText value="#{item.telefone}" rendered="#{item.telefone != ''}">
												<f:converter converterId="telefoneConverter"/>
											</h:outputText>
											<h:outputText value="#{item.email}" rendered="#{item.email != ''}"/>
										</p:column>		

									</p:dataTable>										
									
									<h:panelGrid id="idPngBotoesAcaoContato" columns="1" columnClasses="noBorder">
										<p:commandButton id="cmdLigarPessoaContatoDoCliente"
											value="#{messageBundle['label.generic.button.call']}"
											icon="ui-icon-contact" 
											style="margin:0;width:60px;"
											oncomplete="handleLigacaoPessoaContatoCompletada(xhr, status, args)"
											onclick="dlgCalling.show()"
											actionListener="#{atendimentoBean.ligarParaPessoaDeContato}" 
											ajax="true"
											process="@this,:frmAtendimento:idTabAtendimento:pgdTablesContato"
											update=":frmAtendimento:idPanelGridBarraBotoesGACPhonePessoaContato"
											disabled="#{atendimentoBean.disabledCmdLigarPessoaContatoDoCliente}"/>
										<p:commandButton id="cmdSmsPessoaDeContatoCliente"
											value="#{messageBundle['label.generic.button.sms']}"
											icon="ui-icon-contact" 
											style="margin:0;width:60px;" 
											type="buttom" 
											onclick="modalSmsPessoaContatoDoCliente.show();"
											disabled="#{atendimentoBean.disabledCmdSmsPessoaDeContatoCliente}"/>
										<p:commandButton id="cmdEmailPessoaDeContatoCliente"
											value="#{messageBundle['label.generic.button.email']}"
											icon="ui-icon-mail-closed" 
											style="margin:0;width:60px;" 
											type="buttom"
											onclick="modalEmailPessoaContatoDoCliente.show()"
											disabled="#{atendimentoBean.disabledCmdEmailPessoaDeContatoCliente}"/>								
									</h:panelGrid>
										
										
					            
					        </h:panelGrid>  
					    </p:tab>  
					     <p:tab title="Ocorrências">  
					        <h:panelGrid columns="1">  
					        
					        	<h:panelGrid id="idPgdGrupocombosOcorrencia" columns="3">
							 		<h:outputText value="Tipo Ocorrência " styleClass="text-bold" />  
							        <h:outputText value="Status da Ocorrencia" styleClass="text-bold" />
							        <h:outputText value="Script" styleClass="text-bold" />
							        <p:selectOneMenu id="cmbTipoOcorrencia" value="#{atendimentoBean.ocorrenciaEmAndamento.tipoOcorrencia.codigoTipoOcorrencia}" style="width:200px;">
							            <f:selectItems value="#{atendimentoBean.listaTiposCorrencia}"/> 						            
							        </p:selectOneMenu>						 		  
							        <p:selectOneMenu id="cmbStatusOcorrencia" value="#{atendimentoBean.ocorrenciaEmAndamento.statusOcorrencia}" style="width:200px;">
							            <f:selectItems value="#{atendimentoBean.listaStatusOcorrencia}"/> 						            
							        </p:selectOneMenu> 		
							        <p:selectOneMenu id="idCmbScript" value="#{atendimentoBean.scriptAtendimentoSelecionado}" style="width:300px;">
							            <f:selectItem itemValue="0" itemLabel="Selecione um script" />
							            <f:selectItems value="#{atendimentoBean.listaScriptAtendimento}"/>
							        </p:selectOneMenu> 								        
						        </h:panelGrid>		        			        
					      	   <h:outputText value="#{messageBundle['label.generic.field.descricao']}" styleClass="text-bold"/>
					           <p:inputTextarea style="width:960px;" rows="10" value="#{atendimentoBean.ocorrenciaEmAndamento.descricao}"/>
					           <h:outputText value="#{messageBundle['label.generic.field.resolucao']}" styleClass="text-bold"/>
					           <p:inputTextarea style="width:960px;" rows="10" value="#{atendimentoBean.ocorrenciaEmAndamento.resolucao}"/>
					        </h:panelGrid>  
					    </p:tab>  
					    <p:tab title="Historico">  
					        <h:panelGrid id="idPgdHistoricoOcorrencia" columns="1" >					        
					        	<p:dataTable id="idDtbHistorivo" var="item"
					        			selection="#{atendimentoBean.ocorrenciaSelecionada}"
										selectionMode="single"	
										value="#{atendimentoBean.ocorrenciaDataModel}" rendered="true"
										emptyMessage="#{messageBundle['message.atendimento.datatable.historico.empty']}">
																				
										<p:ajax event="rowSelect" 
											update=":frmAtendimento:idTabAtendimento:idTxtHistoricoDescricao, :frmAtendimento:idTabAtendimento:idTxtHistoricoResolucao" /> 
										
										<p:column>
											<f:facet name="header">
												<h:outputText
													value="Data da Abertura" />
											</f:facet>
											<h:outputText value="#{item.dataAbertura}" >
												<f:convertDateTime pattern="dd/MM/yyyy" locale="#{atendimentoBean.locale}" />
											</h:outputText>												
										</p:column> 
										
										<p:column style="width:100px;">
											<f:facet name="header">
												<h:outputText
													value="Usuário" />
											</f:facet>
											<h:outputText value="#{item.usuario.login}" />												
										</p:column> 	
																			
										<p:column style="width:200px;">
											<f:facet name="header">
												<h:outputText
													value="Tipo" />
											</f:facet>
											<h:outputText value="#{item.tipoOcorrencia.descricaoTipoOcorrencia}" />	
										</p:column> 	
										
										<p:column style="width:250px;">
											<f:facet name="header">
												<h:outputText
													value="Atendente" />
											</f:facet>
											<h:outputText value="#{item.usuario.nomeUsuario}" />												
										</p:column> 																												
															          
										<p:column >
											<f:facet name="header">
												<h:outputText
													value="Data Encerramento" />
											</f:facet>
											<h:outputText value="#{item.dataHoraFechamentoOcorrencia}"  >
												<f:convertDateTime pattern="dd/MM/yyyy hh:mm:ss" locale="#{atendimentoBean.locale}" />
											</h:outputText>												
										</p:column> 															          
					           </p:dataTable>
					           
					           
					           <h:outputText value="#{messageBundle['label.generic.field.descricao']}" styleClass="text-bold"/>
					           <p:inputTextarea id="idTxtHistoricoDescricao" 
					           		value="#{atendimentoBean.ocorrenciaSelecionada.descricao}"
					           		style="width:960px;" rows="10"
					           		disabled="false" readonly="true"/>
					           <h:outputText value="#{messageBundle['label.generic.field.resolucao']}" styleClass="text-bold"/>
					           <p:inputTextarea id="idTxtHistoricoResolucao" 
					           		value="#{atendimentoBean.ocorrenciaSelecionada.resolucao}"
					           		style="width:960px;" rows="10"
					           		disabled="fale" readonly="true"/>
					           
					        </h:panelGrid>  
					    </p:tab>  
					    <p:tab title="Doenças e Tratamentos">  
					        <h:panelGrid columns="2" columnClasses="alignLeftTop, alignLeftTop">	
					        	 <h:outputText value="Doenças" styleClass="text-bold"/>	
					        	 <h:outputText value="Tratamento" styleClass="text-bold"/>	
					        	 			            
					             <p:selectOneListbox id="basic" value="0" style="width:300px; height:200px;">  
							            <f:selectItems value="#{atendimentoBean.listaDoencasDocliente}"/>
							     </p:selectOneListbox>  
							     
								<p:dataTable id="idDtbTratamento" var="item" 
										value="#{atendimentoBean.contrato.cliente.listaTratamentos}" rendered="true"
										emptyMessage="#{messageBundle['message.atendimento.datatable.tratamentos.empty']}" style="text-align:'left'">
																																							
										<p:column style="width:250px;" >
											<f:facet name="header">
												<h:outputText
													value="Nome" />
											</f:facet>
											<h:outputText value="#{item.nomeTratamento}" />										
										</p:column> 	
										
										<p:column style="width:300px;">
											<f:facet name="header">
												<h:outputText
													value="Descrição" />
											</f:facet>
											<h:outputText value="#{item.descricaoTratamento}" />												
										</p:column> 																												
															          
										<p:column style="width:100px;">
											<f:facet name="header">
												<h:outputText
													value="Última Aplicação" />
											</f:facet>
											<h:outputText value=" " />												
										</p:column> 															          
					           </p:dataTable>							     
							     				             
					        </h:panelGrid>  
					    </p:tab>  
					   					    
					</p:tabView>

					<!-- Barra de botões -->
					<h:panelGrid columns="1" id="idPanelGridBarraBotoesOcorrencia"
						style="width:100%;text-align:right !important;padding-right:0px;">
						<h:panelGroup>
							<p:commandButton id="cmdSalvarDadosDaOcorrencia"
								value="#{messageBundle['label.generic.button.save']}"
								icon="ui-icon-check" style="margin:0"
								process="@this, :frmAtendimento:idTabAtendimento"
								actionListener="#{atendimentoBean.salvarDadosOcorrencia}" 
								update=":frmAtendimento:growMessage"
								onclick="dlgWaiting.show()"
								oncomplete="handleSaveRequest(xhr, status, args)"/>								
							<h:outputLabel />
						</h:panelGroup>
					</h:panelGrid>
					<h:panelGrid></h:panelGrid>			
				</h:panelGrid> 					
	
			</div>
			
			<!-- MODAL -->
			<p:dialog id="modalDadosMaisTarde" header="Mais tarde" widgetVar="modalDadosMaisTarde" modal="true" >
				<h:panelGrid columns="1" id="idPgdCamposLigarMaisTarde"
								cellpadding="0" style="width:100%;">
						<p:calendar pattern="dd/MM/yyyy HH:mm" />
								
						<p:panelGrid columns="1"
							style="width:100%;text-align:right !important;padding-right:0px;">
							<h:panelGroup>
								<p:commandButton id="cmdSalvar"
									value="#{messageBundle['label.generic.button.save']}"
									icon="ui-icon-check" style="margin:0"
									onclick="modalDadosMaisTarde.hide();" />
								<h:outputText value=" " />													
								<p:commandButton
									value="#{messageBundle['label.generic.button.close']}"
									type="button"
									onclick="modalDadosMaisTarde.hide();" />
							</h:panelGroup>
						</p:panelGrid>											
				</h:panelGrid>				
			</p:dialog>			
			
			<!-- popups -->			
			<ui:include src="atendimento/modal_contrato.xhtml" />
			<ui:include src="atendimento/modal_pessoa_contato_cliente.xhtml" />
			<ui:include src="atendimento/modal_dispositivo.xhtml" />			
			<ui:include src="atendimento/modal_sms_pessoa_contato.xhtml" />
			<ui:include src="atendimento/modal_email_pessoa_contato.xhtml" />
		</h:form>
				
	</h:body>	
</f:view>
</html>

